# Information Security Logging and Monitoring Procedure

## Statement of Confidentiality
The information contained in this document is internal to Trianz. It shall not be disclosed, duplicated, or used for any purpose other than that stated herein, in whole or in part, without the express written consent of Trianz.

## Information Classification
- Public
- Internal
- Confidential
- Restricted

## Table of Contents
1. Objectives
2. Scope
3. Procedure
   - 3.1 Purpose of Monitoring
   - 3.2 Audit Trail Rules
   - 3.3 Monitoring of System Use
   - 3.4 Logging: Control
   - 3.5 Purpose
   - 3.6 Protection of logs
   - 3.7 Log Analysis
   - 3.8 Monitoring of Firewall Audit Reports
   - 3.9 Windows Environment
   - 3.10 Oracle Environment
   - 3.11 Cloud Environment
4. ISO Control Mapping(s)

## 1. Objectives
- Monitor the logging of events and associate each logged event with a particular user.
- Provide a mechanism to retrieve and report information on logged events.
- Report on the effectiveness and compliance with standards, including but not limited to ISO 27001: 2022 & ISO 27701: 2019.

## 2. Scope
This procedure applies to all Trianz users and operating units, including third parties, Cloud Providers, Cloud Customers, and all Trianz Information System Resources, including corporate data, application, and systems software.

## 3. Procedure

### 3.1 Purpose of Monitoring
- Safeguard information and computing resources from various business and environmental threats by monitoring the use of Trianz Information System Resources.
- Ensure that information on these systems is not disclosed to unauthorized individuals and that data integrity is maintained.
- Ensure conformity to the Logical Access Security Policy and related procedures, including Backup Methods.

### 3.2 Audit Trail Rules
- Auditing must be enabled on all Servers and Network Devices to record exceptions and other security-related events.
- All audit records should be sent to a central server for monitoring and correlation, if possible.
- Retain all physical and logical access logs, audit trails, etc., for a minimum of five years.
- Create a record of successful system access and rejected attempts. Audit trails must include:
  - User IDs
  - Date/time of the most recent attempt
  - Dates and times for logon and logoff
  - Terminal identity or location identifier
  - IP address and source
  - Computer name and source

### 3.3 Monitoring of System Use
- Monitor system use to ensure users are performing explicitly authorized processes.
- Determine the level of monitoring required for individual systems through a separate risk assessment. Areas to monitor include:
  - Access failures
  - Allocation and use of accounts with privileged access capability
  - Tracking of selected transactions
  - Use of sensitive resources
  - IDS/IPS activity
  - Firewall activity
  - Operating System and application access attempts
  - Cloud account access details
  - Malware and ransomware detection alerts from antivirus software
  - Real-time alerts for publicly accessible systems (e.g., external websites) for any suspicious user activity
  - Browser weaknesses and updates

### 3.4 Logging: Control
- Produce, store, protect, and analyze logs that record activities, exceptions, faults, and other relevant events.

### 3.5 Purpose
- Record events, generate evidence, ensure the integrity of log information, and prevent against unauthorized access.

### 3.5 Logging Requirements

The organization must establish a policy on logging that includes the following:

- **Purpose of Logs**: Define the purpose for which logs are created, the data collected, and specific requirements for protecting and handling log data.
- **Event Log Contents**: Each event log should include:
  - User IDs
  - System activities
  - Dates, times, and details of relevant events (e.g., log-on and log-off)
  - Device identity, system identifier, and location
  - Network addresses and protocols

- **Events to Log**: The following events should be logged:
  - a) Successful and rejected system access attempts
  - b) Successful and rejected data and resource access attempts
  - c) Changes to system configuration
  - d) Use of privileges
  - e) Use of utility programs and applications
  - f) Files accessed and the type of access, including deletion of important data files
  - g) Alarms raised by the access control system
  - h) Activation and deactivation of security systems (e.g., anti-virus and intrusion detection systems)
  - i) Creation, modification, or deletion of identities
  - j) Transactions executed by users in applications, including those provided by third parties

- **Time Synchronization**: All systems must have synchronized time sources to enable log correlation for analysis, alerting, and incident investigation.

### 3.6 Protection of Logs

- **User Permissions**: Users, including those with privileged access, must not have permission to delete or deactivate logs of their own activities to prevent manipulation.
- **Log Protection Controls**: Implement controls to protect against unauthorized changes and operational issues, including:
  - a) Alterations to recorded message types
  - b) Editing or deleting log files
  - c) Failure to record events or overwriting past events due to storage limitations

- **Log Protection Techniques**: Consider using the following techniques for log protection:
  - Cryptographic hashing
  - Append-only and read-only file recording
  - Public transparency file recording

- **Log Archiving**: Some audit logs may need to be archived due to data retention requirements or to collect and retain evidence.

- **De-identification for Vendor Logs**: When sending logs to a vendor for debugging or troubleshooting, de-identify logs using data masking techniques for sensitive information (e.g., usernames, IP addresses, hostnames, organization names).

### 3.7 Log Analysis

- **Purpose of Log Analysis**: Log analysis should focus on identifying unusual activity or anomalous behavior that may indicate a compromise.

- **Analysis Considerations**: The analysis should include:
  - a) Necessary skills for the analysts
  - b) Procedures for log analysis
  - c) Required attributes of each security-related event
  - d) Exceptions identified through predetermined rules (e.g., SIEM, firewall rules, IDS, malware signatures)
  - e) Comparison of known behavior patterns and standard network traffic against anomalous activity
  - f) Results from trend or pattern analysis using data analytics and specialized tools
  - g) Available threat intelligence

### 3.7 Log Analysis and Monitoring Activities

Log analysis should be supported by specific monitoring activities to identify and analyze anomalous behavior, which includes:

- Reviewing successful and unsuccessful attempts to access protected resources, such as:
  - Domain Name System (DNS) servers
  - Web portals
  - File shares

- Checking DNS logs to identify outbound network connections to malicious servers, including those associated with botnet command and control servers.

- Examining usage reports from service providers (e.g., invoices or service reports) for unusual activity within systems and networks by reviewing patterns of activity.

- Including event logs of physical monitoring, such as entrance and exit logs, to ensure more accurate detection and incident analysis.

- Correlating logs to enable efficient and highly accurate analysis. Suspected and actual information security incidents, such as malware infections or probing of firewalls, should be identified and subject to further investigation as part of an information security incident management process.

- Utilizing suitable utility programs or audit tools to perform file interrogation to help identify significant events for information security monitoring purposes.

- Implementing automated monitoring systems that generate consolidated reports and alerts on system security.

- Using a Security Information and Event Management (SIEM) tool or equivalent service to store, correlate, normalize, and analyze log information, and to generate alerts. Careful configuration is required to optimize benefits, including:
  - Identification and selection of appropriate log sources
  - Tuning and testing of rules
  - Development of use cases

- Utilizing public transparency files for recording logs, such as those in certificate transparency systems, to provide an additional detection mechanism against log tampering.

- In cloud environments, log management responsibilities can be shared between the cloud service customer and the cloud service provider, with responsibilities varying based on the type of cloud service used.

### 3.8 Monitoring of Firewall Audit Reports

- The designated IS Administrator in the IS Department will review the Internet connection audit reports created on the firewall for any unusual or suspicious activities.
- The review period should not exceed one week.
- Alarms must be configured to alert the IS Administrator about any suspected activities, security breaches, or violations, including but not limited to:
  - A session being initiated from the external world
  - Spoofing activities
  - Suspicious activities occurring internally and from external sources
  - Well-known hacker signatures
  - Password guessing attempts
  - Unauthorized privilege usage attempts
  - Modifications to production application software
  - Modifications to system software
  - Beaconing behavior towards suspicious domains

### 3.9 Windows Environment Logging and Reporting Details/Test

- Windows provides several monitoring and auditing tools that enable powerful logging and auditing. In the absence of auditing and logging, it may not be possible to:
  - Track the attacker in the event of a security breach
  - Detect unauthorized access attempts to resources
  - Track the causes of errors or unauthorized changes
  - Control changes to critical settings, such as the Registry

- Therefore, detective controls become weak without appropriate monitoring and auditing.

- It is recommended to effectively use the auditing and monitoring features of Windows. Some of the events to monitor include:
  - Audit account logon events: Success, Failure
  - Audit account management: Success, Failure
  - Audit directory service access: Failure
  - Audit logon events: Success, Failure
  - Audit object access: Failure

### 3.9 Audit Policy

- **Audit Policy Change**: 
  - Status can be either Success or Failure.

- **Audit Privilege Use**: 
  - Status is Failure.

- **Audit Process Tracking**: 
  - No auditing is conducted.

- **Audit System Events**: 
  - Status can be either Success or Failure.

- **UNIX Environment**:
  - The following system logs should be reviewed and have restricted access:
    - **/etc/wtmp**: Contains a history of system logins. This file is not plain text and must be interpreted using a UNIX utility such as “who”.
    - **/usr/adm/sulog**: Logs the use of the `su` command, which can compromise security by accessing files belonging to other users without their knowledge. Access requires knowledge of the file owner's password, and inappropriate use of this command indicates misuse of passwords by other users.
    - **/usr/bin/uulog**: Contains a history of each use of `uucp`, `uuto`, and `uux`.
    - **/etc/security/failedlogin**: Review this log to determine the list of failed login attempts.
    - Enable logging for specific commands such as `kill`, `killall`, `chown`, `chmod`, `shutdown`, and `chgrp` using TCB (if installed).
    - For FTP services, maintain FTP logs as this service is critical and sensitive from a security perspective. Regular monitoring of FTP activities is recommended.
    - The most important files to review are **/usr/adm/syslog** and **/usr/adm/messages** (or equivalent). Enabling only selected auditing features may have limited effects on the performance of the Application or Server.

### 3.10 Oracle Environment

- **Logging and Reporting Details/Test**:
  - Adopt policies and procedures to review audit trails in a timely manner and develop an audit trail archiving strategy that addresses:
    - Archive rotation period (the time before an archive can be overwritten).
    - Security of the audit trails (confidentiality and integrity).
    - Redundancy of the audit trails (disaster recovery planning).
  
- **Auditing Features**:
  - Enable auditing features in a database according to business and operational requirements.
  - The concerned Department must identify relevant critical tables in a database that need to be kept confidential and enable auditing features for those areas.
  - If logs of User transactional level details at the Application level are captured, Database Level Auditing can be restricted to key actions such as account logon and modification to system settings.
  - Identify activities for monitoring based on their impact on business or operations and analyze their effect on system performance over a period.

- **Auditing Features to be Logged**:
  - Application Account Activity
  - Failed Attempts to Access Objects
  - Failed Attempts to Issue Sensitive Commands
  - Failed Connections
  - Failed Login Attempts

- **Fire Call Accounts**:
  - 'Fire call' accounts have a very high level of privilege and are used only for emergency purposes. These accounts should be secured, and actions performed by them must be audited to identify irregular or unauthorized use and to reference events during emergencies.
  - If actions by 'Fire call' accounts are not audited, irregular or unauthorized use could go unnoticed, and retracing events during an emergency would not be possible.

### 3.11 Cloud Environment

- Trianz will maintain logs of Operations and Maintenance for necessary Corrective Action and Preventive Action (CAPA).

### 4. ISO Control Mapping(s)

#### 4.1 Technological Control
- **8.15 Logging Control**: Control logs that record activities, exceptions, faults, and other relevant events must be produced, stored, protected, and analyzed.
- **8.16 Monitoring Activities Control**: Networks, systems, and applications must be monitored for anomalous behavior, and appropriate actions must be taken to evaluate potential information security incidents.

#### 4.2 Organizational Controls
- **5.28 Collection of Evidence Control**: The organization must establish and implement procedures for the identification, collection, acquisition, and preservation of evidence related to information security events.

### Document Control
- **Owner**: CISO
- **Release ID**: ISAM-PROC-0044

### Version History
- **0.00** (19-Feb-07): Initial draft by Jyotessh G Nair
- **1.00** (26-Feb-07): Approved Baseline by Jyotessh G Nair, approved by Zulfikar Deen.
- **1.01** (14-May-09): Consolidated controls related to audit by Bharateesha B R.
- **2.00** (03-Jun-09): Approved Baseline by Balu Nair.
- **2.01** (30-Dec-10): Formatting updates by Chakravarthi.
- **3.00** (30-Dec-10): Baselined by Chakravarthi.
- **3.01** (24-May-11): Modified release ID for consistency by Srilakshmi.
- **4.00** (24-May-11): Baselined by Srilakshmi.
- **4.01** (3-Aug-11): Replaced Owner with Management Representative in Document Classification Scheme by Sudarsana.

### 5.00 Document Updates
- On 3-Aug-11, a request for baseline was approved and baselined.

### 6.00 Document Formatting
- On 28-Sep-12, the document was formatted as per the latest template format following a QMG review.

### 6.01 Cloud Services Addition
- On 16-Oct-16, the procedure was modified to align with cloud service-related process steps. 
- Vulnerability Assessment and Penetration Testing (VAPT) were added under section 4.8.

### 7.00 CISO Approval
- On 07-Dec-16, the document was approved by the CISO and baselined.

### 8.00 Document Review
- On 23-Jun-18, the documents were reviewed with no changes made.

### 8.1 Information Classification Update
- On 29-Apr-19, the following modifications were made:
  - Information classification was modified.
  - The Trianz logo was modified.
  - No major changes were made.

### 9.0 Document Release Approval
- On 14-May-19, the document was approved for release and baselined.

### 10.0 Roles and Responsibilities Update
- On 24-Nov-19, roles and responsibilities were updated to align with ISO 27017 & 27018 standards.

### 10.1 Document Format Integration
- On 11-May-20, the document was integrated into a new format.

### 11.0 Document Approval
- On 14-May-20, the document was approved and baselined.

### 11.1 Information Classification Review
- On 14-Jan-21, the information classification was updated, and formatting corrections were made.

### 11.2 Audit Trail and Monitoring Update
- On 11-Feb-21, audit trail rules and monitoring of system bulletins were updated.

### 12.0 Baseline Approval
- On 12-Feb-21, the document was approved for baseline and baselined.

### 12.1 Format Changes Review
- On 07-Oct-21, format changes were reviewed.

### 13.0 Document Approval
- On 11-Oct-21, the document was approved and baselined.

### 14.0 Updates and Review
- On 30th October 2021, updates were made to Section 3.3 regarding the monitoring of Browser Weakness and Updates.
- On 21st December 2021, there were no changes during the annual review.
- On 6th January 2023, the log retention period was modified as per client feedback.
- On 6th January 2023, the document was approved and baselined.
- On 28th March 2023, the document was reviewed with no changes.

### 16.0 Approval
- On 12th May 2023, the document was approved and baselined.
- On 15th February 2024, the document was mapped with New ISO control 27k, 2022 sections 8.15 and 8.16 for review.

### 17.0 Approval
- On 23rd February 2024, the document was approved and baselined.
- On 2nd May 2025, the document was migrated to a new template for review.

### 18.0 Approval
- On 14th May 2025, the document was approved and baselined.

### Contact Information
- For inquiries, please contact:  
  - **Email:** infosec@trianz.com

### Copyright Notice
- The content in this document is copyrighted. Unauthorized use may violate copyright, trademark, and other laws. The document may not be modified, reproduced, or publicly displayed without permission.