# Threat Modelling Procedure

## Statement of Confidentiality
The information contained in this document is internal to Trianz. It shall not be disclosed, duplicated, or used for any purpose other than that stated herein, in whole or in part, without the express written consent of Trianz.

## Information Classification
- Public
- Internal
- Confidential
- Restricted

## Table of Contents
1. INTRODUCTION
2. OBJECTIVE(S)
3. SCOPE
4. THREAT MODELING PROCESS
   - 4.1 Identify Asset
   - 4.2 Application Overview
   - 4.3 Dissect the Application
   - 4.4 Identify and rank threats
     - 4.4.1 STRIDE
     - 4.4.2 DREAD
   - 4.5 Identify Vulnerabilities
   - 4.6 Conclusion
5. ROLES AND RESPONSIBILITIES
6. PROCESS FLOW
7. PREREQUISITES
   - 7.1 Reference Policy, Process, Procedure, Templates, Checklist
8. STANDARDS ADDRESSED
9. ISO CONTROL MAPPING(S)

## Glossary
- **Risk**: The effect of uncertainty on objectives.
- **SDL**: Secure Development Life Cycle.
- **SDLC**: Software Development Life Cycle.
- **Threat**: A potential cause of an unwanted incident that may result in harm to a system or organization.
- **Vulnerability**: An instance of a weakness as manifested in a specific implementation.
- **Attack**: An attempt to damage or gain access to the system.
- **DFD**: Data Flow Diagrams.

## 1. Introduction
Threat modeling is an approach for analyzing the security of an application. It is a structured method that enables the identification, quantification, and addressing of security risks associated with an application. Incorporating threat modeling into the SDLC ensures that applications are developed with security built-in from the beginning. Threat modeling must align with the organization’s development practices and follow design changes in manageable iterations.

## 2. Objective(s)
The objectives of Threat Modeling are:
1. To define the security of the application.
2. To identify and investigate potential threats and vulnerabilities.
3. To find architecture bugs earlier.
4. To accurately determine the attack surface for the application.
5. To assign risk to various threats.
6. To drive the vulnerability mitigation process.

## 3. Scope
The scope includes all internal and applicable vendor applications that are owned, operated, maintained, and controlled by Trianz, whether internally or externally, on premises or in the cloud.

## 4. Threat Modeling Process
Threat modeling is a systematic and strategic approach for identifying and enumerating threats to an application environment with the objective of minimizing risk and associated impacts. It is applied continuously throughout the software development lifecycle. The process involves identifying and prioritizing potential threats, documenting harmful events, and determining actions to resolve them. Use the Policies & standards, Legal/Compliance directives, and business requirements to list the security objectives.

## 4.1 Identify Asset
- The first step of threat modeling is to understand how the application interacts with internal and external entities.
- Identify entry points, privilege boundaries, access control matrix, data flow, and privileged components.

### 4.2 Application Overview
- The threat modeling process aims to understand the application and its interactions with external entities.
- To create an application overview, the following steps should be taken:
  - Draw the end-to-end deployment scenario.
  - Identify roles involved in the application.
  - Identify key usage scenarios.
  - Identify technologies used in the application.
  - Identify application security mechanisms.
  - Create use-cases to understand application usage and identify entry points for potential attackers. Use and abuse cases can illustrate how protective measures may be bypassed or where protections are lacking.

### 4.3 Dissect the Application
- Break down the application to identify:
  - Trust boundaries
  - Data flows
  - Entry points
  - Exit points
- Produce Data Flow Diagrams (DFDs) and architectural diagrams for the application. A DFD depicts how information flows through the system, showing where data is input or output from each process or subsystem, including storage locations.
- DFDs highlight privilege boundaries, which are locations where data changes its level of trust. Trust boundaries typically occur where data is passed between processes.
- DFDs help identify potential threat targets from an attacker's perspective, such as data sources, processes, data flows, and user interactions.

### 4.4 Identify and Rank Threats
- Conduct threat analysis to identify threats to the application by analyzing its functionality, architecture, and design to classify potential weaknesses that could lead to exploitation.
- Use the STRIDE threat methodology to define threat categories, including:
  - Auditing & Logging
  - Authentication
  - Authorization
  - Configuration Management
  - Data Protection in Storage and Transit
  - Data Validation
  - Exception Management
- Determine the security risk for each threat using a value-based risk model such as DREAD.

#### 4.4.1 STRIDE
- The STRIDE threat model focuses on the potential impacts of different threats to a system:
  1. **Spoofing**: An adversary poses as another user or system to illegally access credentials (Security Control: Authentication).
  2. **Tampering**: Maliciously changing or modifying persistent data, including data in transit (Security Control: Integrity).
  3. **Repudiation**: Performing illegal operations in a system without the ability to trace them (Security Control: Non-Repudiation).
  4. **Information Disclosure**: Exposing protected data to unauthorized users (Security Control: Confidentiality).
  5. **Denial of Service**: Illegitimate means used to assume a higher trust level with different privileges (Security Control: Availability).
  6. **Elevation of Privilege**: Gaining privileged access to resources (Security Control: Authorization).

### 4.4.2 DREAD

- The DREAD methodology is used to rate, compare, and prioritize the severity of risks presented by each threat classified using STRIDE. 
- Threats are ranked based on risk factors, allowing us to address the most problematic threats first and then resolve alternate threats.
- The DREAD model is a quantitative risk analysis tool that assesses the severity of a cyber threat, determining both past and potential future damage.
- When assessing a cyber threat, various key points must be evaluated, and a numbered rating assigned to each. The total rating is then compared to the DREAD model’s rating system to classify the threat as low, medium, or high risk.
- Five key points must be scrutinized when using the DREAD model to assess threat severity:
  1. Damage
  2. Reproducibility
  3. Exploitability
  4. Affected Users
  5. Discoverability
- Ratings assigned must be either one, three, or nine:
  - A rating of **1** indicates low risk.
  - A rating of **3** indicates moderate risk.
  - A rating of **9** indicates high risk.
  
#### Discoverability Ratings
- The following ratings are used to assess Discoverability:
  - **1**: Very hard to discover; requires source code or administrative access.
  - **3**: Can be discovered by querying or analyzing application data flow.
  - **9**: Published information explains the attack; the vulnerability is in a commonly used feature and is very noticeable.

- Threats should be prioritized as follows:
  - **First**: High Risk
  - **Second**: Medium Risk
  - **Last**: Low Risk

#### DREAD Calculation
- The DREAD score is calculated as follows:
  - **DREAD = (Damage * Reproducibility * Exploitability * Affected Users * Discoverability)**

#### DREAD Risk Levels
- The DREAD risk levels are defined as:
  - **Low**: DREAD Risk value < 81
  - **Medium**: DREAD Risk value between 81 and 243 (inclusive)
  - **High**: DREAD Risk value > 243

- Risk assessment is conducted after the threat modeling process to map each threat to either a mitigation mechanism or to ignore it.
- A risk assessment will be performed if the DREAD Risk value is Medium or High (DREAD value > 81).
- If the DREAD value exceeds 81, identify vulnerabilities, impacts, and the probability of occurrence of those vulnerabilities. Refer to the Risk and Opportunity Management Policy for further risk assessment guidance.

### 4.5 Identify Vulnerabilities
- Vulnerabilities must be identified by examining the application layer by layer, considering each vulnerability category in each layer.
- Ensure identification of the OWASP Top 10 Vulnerabilities, which include:
  - Authentication
  - Authorization
  - Input and Data Validation
  - Configuration Management
  - Sensitive Data
  - Parameter Manipulation
  - Session Management
  - Cryptography
  - Exception Management
  - Auditing and Logging

### 4.6 Conclusion
- Threat modeling should be... (text incomplete).

### 5. Roles and Responsibilities

- **Internal App Team**: 
  - Identify security objectives and create data flow diagrams and architectural diagrams. 
  - This role is classified as Internal.

- **IS Team**: 
  - Identify threats and vulnerabilities to the application and rank the threats. 
  - This role is classified as Internal.

### 7. Prerequisites

#### 7.1 Reference Policy, Process, Procedure, Templates, Checklist
- **Document Name**:
  - Secure SDLC Procedure
  - Risk and Opportunity Management Procedure

### 8. Standards Addressed
- ISO 9001:2015 Standard
- ISO 27001:2022 Standard
- ISO 20000-1:2018 Standard

### 9. ISO Control Mapping(s)

- **Category of Control**: Technological Control
  - **ISO 27001:2022 Control**: 8.27 Secure system architecture and engineering principles
  - **Document Name as per ISO 27001:2022**: Threat Modeling Control Principles Procedure
  - Control principles for engineering secure systems shall be established, documented, maintained, and applied to any information system development activities.

### Document Control
- **Owner**: CISO
- **Release ID**: THRT_MOD_PROC_0163

### Version History
- **Version 0.00**: Initial Version (30-July-21) by Divya G, reviewed by Karthik, approved by Phani.
- **Version 1.00**: Request for Baseline (30-July-21) by Divya G, reviewed by Karthik, approved by Phani.
- **Version 1.00**: For review, no changes (05-July-22) by Sanjana, reviewed by Divya, approved by Siva N.
- **Version 1.1**: For Review, reviewed with no changes (25-April-2023) by Krutidee, reviewed by Vijaya R.
- **Version 2.0**: Approved and Baselined (12-May-2023) by Rama Madhavan, reviewed by Vijaya, approved by Srikanth M.
- **Version 2.1**: For Review, mapped to new ISO 27k 2022 Control (11-Feb-24) by Shalini, reviewed by Vijaya, approved by Srikanth M.
- **Version 3.0**: Approved and Baselined (23-Feb-24) by Shalini, reviewed by Vijaya, approved by Srikanth M.
- **Version 3.1**: For Review, migrated to New Template (28-May-25) by Kruti, reviewed by Vijaya.
- **Version 4.0**: Approved and Baselined (29-May-25) by Kruti, reviewed by Vijaya, approved by Srikanth M.

### Contact Information
- **Name**: [To be filled]
- **Email**: [To be filled]
- **Phone**: [To be filled] 

Thank You.

**Copyright Notice**

- The content in this document is copyrighted. Unauthorized use, in part or full, may violate copyright, trademark, and other laws.
- This document may not be modified, reproduced, publicly displayed, performed, distributed, or used for any public or commercial purposes.
- The Trianz name and its products are protected by trademark and copyright laws, regardless of how and where referenced.