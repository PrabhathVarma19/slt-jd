Threat Modelling procedure




TRIANZ INTERNAL              trianz.com
                      Statement of Confidentiality

  The information contained in this document is internal to Trianz. It shall not be
  disclosed, duplicated, or used for any purpose other than that stated herein, in
  whole or in part, without the express written consent of Trianz.




                         Information Classification


     ☐ Public

     ☒ Internal

     ☐ Confidential

     ☐ Restricted




TRIANZ INTERNAL                                                                  2
                               Table of Contents
GLOSSARY                                                              4

1.   INTRODUCTION                                                     5

2.   OBJECTIVE(S)                                                     5

3.   SCOPE                                                            5

4.   THREAT MODELING PROCESS                                          5

     4.1 Identify Asset:                                              6

     4.2 Application Overview:                                        6

     4.3 Dissect the Application:                                     7

     4.4 Identify and rank threats.                                   8

         4.4.1     STRIDE                                             8

         4.4.2     DREAD                                              9

     4.5 Identify Vulnerabilities:                                    12

     4.6 Conclusion:                                                  13

5.   ROLES AND RESPONSIBILITIES                                       13

6.   PROCESS FLOW                                                     13

7.   PREREQUISITES                                                    14

     7.1 Reference Policy, Process, Procedure, Templates, Checklist   14

8.   STANDARDS ADDRESSED                                              14

9.   ISO CONTROL MAPPING(S)                                           15




 TRIANZ INTERNAL                                                      3
                         Glossary
Word/Abbreviation   Description
Risk                the effect of uncertainty on objectives
SDL                 Secure Development Life cycle
SDLC                Software Development Life Cycle
Threat              A potential cause of an unwanted incident that may result in
                    harm to a system or organization
Vulnerability       An instance of a weakness as manifested in a specific
                    implementation
Attack              An attempt to damage or gain access to the system
DFD                 Data Flow Diagrams




 TRIANZ INTERNAL                                                            4
1. Introduction
  Threat modeling is an approach for analyzing the security of an application. It is a
  structured approach that enables you to identify, quantify, and address the
  security risks associated with an application. The inclusion of threat modeling in
  the SDLC can help to ensure that applications are being developed with security
  built-in from the very beginning.

  Threat modeling must align with an organization’s development practices and
  follow design changes in iterations that are each scoped to manageable portions
  of the system.



2. Objective(s)
  Threat Modeling objectives are:

         1. Defines security of application.

         2. Identifies and investigates potential threats and vulnerabilities.

         3. Results in finding architecture bugs earlier.

         4. Accurately determine the attack surface for the application

         5. Assign risk to the various threats.

         6. Drive the vulnerability mitigation process.



3. Scope
  The scope includes all internal and applicable vendor applications that are owned,
  operated, maintained, and controlled by Trianz by internally and externally either
  on premises or on cloud.



4. Threat Modeling Process
  Threat modeling is the systematic and strategic approach for identifying and
  enumerating threats to an application environment with the objective of
  minimizing risk and the associated impacts.




   TRIANZ INTERNAL                                                                       5
It is applied continuously throughout a software development lifecycle. The
process identifies and prioritize potential threats, then document both the harmful
events and what actions to take to resolve them.

Use the Policies & standards, Legal/Compliance directives & business
requirements to list the security objectives.




4.1 Identify Asset:
   •   The first step of threat modeling is to understand how it interacts with internal

       and external entities.

   •   Identify entry points, privilege boundaries, access control matrix, data flow,

       privileged code and technology stacks being used document the security

       profile.



4.2 Application Overview:
   •   Threat modeling process is concerned with gaining and understanding of the

       application and how it interacts with external entities.

   •   To create an application overview:

   •   Draw the end-to-end deployment scenario.

   •   Identify roles.

   •   Identify key usage scenarios.

   •   Identify technologies.

   •   Identify application security mechanisms.

   •   Ensure creating use-cases to understand how the application is used,

       identifying entry points to see where a potential attacker could interact with

       the application. Use and abuse cases can illustrate how existing protective

       measures could be bypassed, or where a lack of such protection exists.


 TRIANZ INTERNAL                                                                           6
4.3 Dissect the Application:
  •   In this step, break down the application to identify trust boundaries, data

      flows, entry points, and exit points.

  •   Ensure producing DFDs & Architectural diagrams for the application. A data

      flow diagram is a depiction of how information flows through your system. It

      shows each place that data is input into or output from each process or

      subsystem. It includes anywhere that data is stored in the system, either

      temporarily or long-term.

  •   The DFDs show the different paths through the system, highlighting the

      privilege boundaries. A trust boundary is a location on the data flow diagram

      where data changes its level of trust. Any place where data is passed

      between two processes is typically a trust boundary.

  •   DFDs helps to identify the potential threat targets from the attacker's

      perspective, such as data sources, processes, data flows, and interactions

      with users.




TRIANZ INTERNAL                                                                       7
4.4 Identify and rank threats.
  •   Threat analysis identifies the threats to the application and involves the

      analysis of each aspect of the application functionality and architecture and

      design to identify and classify potential weaknesses that could lead to an

      exploit.

  •   A threat methodology (STRIDE) can be used to define threat categories such

      as Auditing &

  •   Logging, Authentication, Authorization, Configuration Management, Data

      Protection in Storage and Transit, Data Validation, Exception Management.

      STRIDE helps to identify threats from the attacker.

  •   The determination of the security risk for each threat can be determined

      using a value-based risk model such as DREAD.


      4.4.1 STRIDE
                  • The STRIDE threat model is focused on the potential impacts of
                   different threats to a system:
                           1. Spoofing

                           2. Tampering

                           3. Repudiation

                           4. Information Disclosure

                           5. Denial of Service

                           6. Elevation of Privilege.




STRIDE Type           Description                                             Security
                                                                              Control




TRIANZ INTERNAL                                                                          8
Spoofing              An adversary posing as another user, component, or          Authentication
                      other system that has an identity in the system being
                      modelled. Threat action aimed to illegally access
                      and use another user's credentials, such as
                      username and password
Tampering             Threat action aimed to maliciously change/modify            Integrity
                      persistent data, such as persistent data in a
                      database, and the alteration of data in transit
                      between two computers over an open network, such
                      as the Internet
Repudiation           Threat action aimed to perform illegal operation in a       Non-
                      system that lacks the ability to trace the prohibited       Repudiation
                      operations.
Information           The exposure of protected data to a user that is not        Confidentiality
Disclosure            otherwise allowed access to that data.
Denial        of      Occurs when an adversary uses illegitimate means            Availability
Service               to assume a trust level than he currently has with
                      different privileges.

Elevation     of      Threat aimed to gain privileged access to resources         Authorization
Privilege             for gaining unauthorized access to information or to
                      compromise a system




       4.4.2 DREAD
                  • DREAD methodology is used to rate, compare and prioritize the
                   severity of risk presented by each threat that is classified using
                   STRIDE. Threats can be ranked from the perspective of risk factors.
                  • we rate threats in light of the risks they cast. This leads us to address
                   the threats that are most problematic, and afterwards resolve
                   alternate threats.
                  • The DREAD model is a form of quantitative risk analysis that involves
                   rating the severity of a cyber threat (DREAD model is used to
                   determine how much damage it has already caused and can cause
                   in the future).


TRIANZ INTERNAL                                                                               9
                  • You must assess various key points of the cyber threat while
                   assigning a numbered rating to each of these points. When finished,
                   you can then compare the total rating to that of the DREAD model’s
                   rating system, which should reveal whether the cyber threat has a
                   low, medium or high risk to your business.
                  • When using the DREAD model to assess the severity of a cyber threat,
                   must scrutinize five key points.
                  • Ensure assigning a rating of either one, three or nine. A rating of one
                   indicates a low risk. A rating of three indicating a moderate risk. A
                   rating of nine indicates a high risk
                  • The DREAD model is utilized to figure out the probability of risk, which
                   is abbreviated as:
                             1. Damage

                             2. Reproducibility

                             3. Exploitability

                             4. Affected Users

                             5. Discoverability

                  • Following tables will be used to assign the Damage, Reproducibility,
                   Exploitability, Affected Users, Discoverability rating.




TRIANZ INTERNAL                                                                            10
     Value    Discoverability
              How easy it is to discover this threat
        1     Very hard, requires source code or administrative access
        3     Can figure it out by querying or by analyzing the application data flow
        9     Published information explains the attack. The vulnerability is found in
              the most commonly used feature and is very noticeable.




TRIANZ INTERNAL                                                                      11
                  • Prioritizing the threat in the following way to analyze the risk factor
                   from first to last:
                              First High Risk.

                              Second Medium Risk.

                              Last Low Risk.



                  • DREAD = (Damage * Reproducibility * Exploitability * Affected Users
                   * Discoverability)


      DREAD                               Basis

      Low                                 Value of DREAD Risk<81

      Medium                              Value of DREAD Risk within the range from > =81
                                          to <=243
      High                                Value of DREAD Risk >243



                  • Risk assessment is performed after the threat modeling process in
                   order to map each threat to either a mitigation mechanism or to
                   ignore.
                  • Risk assessment will be performed if DREAD Risk value is Medium or
                   High (DREAD value is greater than (>) 81)
                  • If DREAD value is greater than (>) 81 then Identify Vulnerabilities,
                   Impact and probability of occurrence of vulnerabilities.
                   Refer to Risk and Opportunity Management Policy for risk
                   assessment.


4.5 Identify Vulnerabilities:
  •   Identify vulnerabilities by examine the application layer by layer, considering

      each of the vulnerability categories in each layer.

  •   Ensure       identifying     OWASP     TOP     10   Vulnerabilities   (Authentication,
      Authorization, Input and data



TRIANZ INTERNAL                                                                               12
   Validation, Configuration Management, Sensitive Data, Parameter Manipulation,
                                             Session
         Management, Cryptography, Exception Management, Auditing and
         Logging)


  4.6 Conclusion:
   • Threat modeling should be incorporated into every stage of the Secure SLDC to
      ensure that threats are identified and managed from the initial design of
      software through the final release.




5. Roles and Responsibilities
  Role              Responsibility                     Internal/External
  Internal App      • Identify security                Internal
  Team                 objectives and create
                       data flow diagram and
                       architectural diagram
  IS Team           • Identify threats and             Internal
                       Vulnerabilities to the
                       application and the rank
                       the threats



  6. Process Flow




  TRIANZ INTERNAL                                                                    13
7. Prerequisites

  7.1 Reference Policy, Process, Procedure, Templates, Checklist


Document Name
Secure SDLC Procedure

Risk and Opportunity Management Procedure




8. Standards Addressed
ISO 9001:2015 Standard
ISO 27001:2022 Standard
ISO 20000-1:2018 Standard




TRIANZ INTERNAL                                                    14
9. ISO Control Mapping(s)
    Category of     ISO 27001:2022 Control                  Document Name as
    Control                                                 per ISO 27001:2022
    Technological   8.27 Secure system architecture and     Threat Modeling
    Control         engineering principles Control Principles
                                                              Procedure
                    for engineering secure systems shall be
                    established, documented, maintained
                    and applied to any information system
                    development activities.




TRIANZ INTERNAL                                                                  15
                                           Document Control

      Owner:           CISO                       Release ID:              THRT_MOD_PROC_0163




                  For Trianz Process Improvement Group (TPIG) Purpose Only

       Version History



 Ver.                                                             Reason for          Change
               Date           Author   Reviewer   Approver
  No.                                                               Change          Description

0.00       30-            Divya G      Karthik    Phani         Initial Version   None

           July-21                     N

1.00       30-            Divya G      Karthik    Phani         Request for       Baselined

           July-21                     N                        Baseline

1.00       05July202      Sanjana      Divya      Siva N        For review        No changes
           2

1.1        25-April-      Krutidee     Vijaya R                 For Review        Reviewed with no
           2023           pta,                                                       changes.
                          Rama
                          Madhav                                                  Migrated to new
                          an                                                         template

2.0                       Rama
           12-May-                                                                Approved and
                          Madhav       Vijaya     Srikanth M    For Approval
           2023                                                                     Baselined
                          an

2.1                                                                               Mapped to new
           11-Feb-24      Shalini      Vijaya     Srikanth M    For Review          ISO 27k 2022
                                                                                    Control
3.0        23-Feb-24      Shalini      Vijaya     Srikanth M    For Approval      Approved and
                                                                                    Baselined



        TRIANZ INTERNAL                                                                       16
3.1      28-May-                                                     Migrated to New
                        Kruti   Vijaya                For Review
         25                                                             Template

4.0      29-May-                                                     Approved and
                        Kruti   Vijaya   Srikanth M   For Approval
         25                                                            Baselined




      TRIANZ INTERNAL                                                          17
                                Contact Information
                                               Name

                                               Email

                                              Phone




                                  Thank You
                                     infosec@trianz.com




 The content in this document is copyrighted; any unauthorized use – in part or full – may violate the
 copyright, trademark, and other laws. This document may not be modified, reproduced, or publicly
   displayed, performed, or distributed, or used for any public or commercial purposes. The Trianz
 name and its products are subject to trademark and copyright protections, regardless of how and
                                          where referenced.


TRIANZ INTERNAL                                                                                      18
