# Vulnerability and Penetration Testing Procedure

## Statement of Confidentiality
The information contained in this document is internal to Trianz. It shall not be disclosed, duplicated, or used for any purpose other than that stated herein, in whole or in part, without the express written consent of Trianz.

## Information Classification
- Public
- Internal
- Confidential
- Restricted

## Table of Contents
1. INTRODUCTION
2. OBJECTIVE(S)
3. SCOPE
4. ENTRY CRITERIA
5. INPUT
6. PROCESS DESCRIPTION (PROCEDURE)
   - 6.1 Vulnerability Assessment and Penetration Testing Process
   - 6.2 Vulnerability Assessment
   - 6.3 Pre-Assessment Phase (Information Gathering)
   - 6.4 Assessment Phase (Detection, Analysis and Remediation)
   - 6.5 Post Assessment Phase (Reporting and Monitor)
   - 6.6 Penetration Testing
   - 6.7 Process of Penetration Testing
   - 6.8 Phases of Penetration Testing Methodology
   - 6.9 Attack Phase
   - 6.10 Post Attack Phase
   - 6.11 Specific Risk of VAPT
   - 6.12 Specific Risk of VAPT
   - 6.13 List of Tools for Vulnerability Assessment and Penetration Testing
7. EXIT CRITERIA AND OUTPUT
8. ROLES AND RESPONSIBILITIES
9. PREREQUISITES
   - 9.1 Resource
   - 9.2 Training
   - 9.3 Reference Policy, Process, Procedure, Templates, Checklist
   - 9.4 Acronyms/Abbreviations
10. MEASUREMENT
11. STANDARDS ADDRESSED
12. ISO CONTROL MAPPING(S)

## 1. Introduction
Vulnerability Assessment and Penetration Testing (VAPT) is an integral part of information security best practices. It provides the organization with a comprehensive evaluation of its infrastructure and applications.

## 2. Objective(s)
- Evaluate the weaknesses in Trianz-managed Infrastructure and Information Assets that can be exploited by external and internal attackers.
- Evaluate the effectiveness and ineffectiveness of Trianz security infrastructure and applications implemented by both Trianz and third-party vendors.

## 3. Scope
- The scope includes all Infrastructure, systems, applications, and Information Assets that are owned, operated, maintained, and controlled by Trianz, both internally and externally, either on-premises or in the cloud.

## 4. Entry Criteria
- All critical Projects, Products, and functions identified for VAPT.

## 5. Input
- As per Master Service Agreement (MSA) / Statement of Work (SOW).
- Requirements from the Projects/Products.
- As per the business criticality of the application.

## 6. Process Description (Procedure)

### 6.1 Vulnerability Assessment and Penetration Testing Process
- The responsibility for carrying out vulnerability assessments is assigned to:
  - Information Systems Team
  - Project Team
  - Corporate functions team
  - Product teams
  - An external party

- The broad sets of responsibilities include:
  - **Initiate assessment planning**: The IS Team / Project Team/Product is responsible for initiating the formulation of the Assessment Plan.

### 2. IS Team/Project Team/Product Team Responsibilities

2.1 Check Latest Asset Inventory  
- The IS Team/Project Team/Product Team must check the latest inventory for newly included servers/applications that were not part of the last Vulnerability Assessment (VA) scan.

2.2 Prepare List of Assets in Scope  
- The IS Team/Project Team/Product Team must prepare a list of assets to be included in the assessment and send an email to application/database owners to finalize the devices and seek their inputs or any other relevant information.

2.3 Finalize List of Assets in Scope  
- The IS Team/Project Team/Product Team must prepare the final list of devices after taking input/feedback from other stakeholders.

2.4 Finalize Dates of Assessment  
- The IS Team/Project Team/Product Team must send email communication to application/database teams to finalize the schedule for the assessment.

2.5 Confirm VA/PT Assessment Calendar  
- The IS Team/Internal Apps/Project Team/Product Team must cross-check the dates provided by the InfoSec Team with the calendar and inform the InfoSec Team regarding approval or modification of the dates.

2.6 Confirm VA/PT Assessment Calendar (Application/Database Owner/Product Team)  
- The Application/Database Owner/Product Team must provide any relevant information required by the InfoSec Team prior to the start of the VA/PT assessment.  
- They must also cross-check the dates communicated by the InfoSec Team with the calendar and inform the InfoSec Team regarding approval or rejection.

2.7 Communicate the Assessment Dates  
- The IS Team/Project Team/Product Team must send an email communication to relevant stakeholders upon receipt of a sign-off on the assessment dates.

2.8 Prepare Plan for the Assessment  
- The IS Team/Project Team/Product Team must prepare a day-wise plan for the Vulnerability Assessment and ensure readiness of the following resources:
  - Availability of relevant team members on respective dates.
  - Availability of VA/PT admin user-IDs on all target servers.
  - All other aspects related to starting the VA/PT assessment as per the plan.

### 6.2 Vulnerability Assessment  
- Vulnerabilities are identified at the infrastructure and network level by running tools such as Nessus and Burpsuite with the latest versions.
- For PCI-specific environments, perform vulnerability scans on internal/external IP addresses; use an Approved Scanning Vendor (ASV) and track findings through remediation.
- Alerts and threats published by OEMs and certified agencies must be monitored.
- Alerts and threats published by SANS, OWASP, NVD, and CVSS are helpful for identifying vulnerabilities.
- Before proceeding with the Vulnerability Assessment, the scope of the assessment must be clearly defined based on the asset inventory to be assessed.
- The Vulnerability Assessment process is divided into three phases:
  - Pre-Assessment Phase (Information Gathering)
  - Assessment Phase (Detection, Analysis, and Remediation)
  - Post Assessment Phase (Reporting and Monitoring)

### 6.3 Pre-Assessment Phase (Information Gathering)  
- The VA team must gather information about the asset inventory as prerequisites. The following information must be collected as a minimum:
  - Network architecture view (e.g., MPLS, VLAN).
  - Security appliance configuration (e.g., IDS, IPS, UTM).

### 6.4 Assessment Phase (Detection, Analysis and Remediation)

#### Detection
1. After finalizing devices and assets for assessment, execute the selected vulnerability assessment tool according to the 'day-wise' and 'resource-wise' plan detailed in the asset inventory.
2. Use tools such as Nessus and Burp Suite to identify vulnerabilities in the assets listed in the asset inventory.
3. Classify vulnerabilities, including misconfigurations of patches, operating system versions, and network architecture configurations, based on the asset inventory.
4. Ensure that discovery scanning is enabled on the vulnerability assessment scanner to identify new information assets connected to the Trianz network.
5. Conduct mandatory vulnerability assessment (VA) scanning for all information assets before they access the Trianz network.
6. For associates traveling from high-risk geographic locations with Trianz informational assets (e.g., laptops), conduct mandatory VA scanning on the information assets post-travel before connecting to the Trianz network.

#### Analysis
1. Analyze and prioritize vulnerabilities based on their criticality and impact, using the Common Vulnerability Scoring System (CVSS) for scoring.
2. Utilize the Common Vulnerabilities and Exposure (CVE) database for vulnerability analysis.

#### Vulnerability Severity Rating
1. Check the severity of vulnerabilities according to the asset inventory in the risk register, as outlined in the Risk Management Procedure.

#### Remediation
1. Remediate vulnerabilities according to a calendar schedule, with revalidations performed to ensure closure.
2. Remediation will be carried out by the asset owner, and a review will be conducted by the CIO/CISO prior to approval.

### Tracking Closure of Identified Vulnerabilities

#### Flow Chart Process Descriptions
1. **Responsibility:** IS Team/Project Team  
   **Process Name:** Discuss the VA Report  
   **Process Description:** Recommendations are discussed with the IS Operations team.

2. **Responsibility:** IS Team/Project Team  
   **Process Name:** Finalize Timelines  
   **Process Description:** Agree on timelines for fixing the vulnerabilities.

3. **Responsibility:** IS Team/Project Team/Internal Apps  
   **Process Name:** Share Reports  
   **Process Description:** Share the report with the application and database team to fix timelines for closure.

4. **Responsibility:** IS Operations/Internal Apps  
   **Process Name:** Implement the Recommendations  
   **Process Description:** Implement the recommendations provided for the vulnerabilities that can be closed.

5. **Responsibility:** IS Operations/Internal Apps  
   **Process Name:** Update on Implementation Status  
   **Process Description:** Provide updates to the IS and application/database team.

6. **Responsibility:** IS Operations/Internal Apps  
   **Process Name:** Discussion with InfoSec Team  
   **Process Description:** Schedule a discussion with the InfoSec team.

### 7. Remediation Status
- The InfoSec Team must document vulnerabilities along with reasons for non-closure.
- If all vulnerabilities have been remediated, submit the report to the InfoSec Team for review.
- If vulnerabilities remain, follow the exception management procedure.

### 8. Exception Management Process
- Initiate the Exception Management Process if there is a vulnerability that cannot be fixed due to a valid requirement.

### 9. Review Reports / Exceptions
- The CIO/CISO will review the final remediation report and the exceptions raised for approval.
- If the CIO/CISO is unsatisfied, the InfoSec Team will request the concerned team to further mitigate the vulnerability.

### Timeline for Fixing Vulnerabilities
- **Critical Severity**: Mitigation time is 1 day.
- **High Severity**: Mitigation time is 7 days.
- **Medium Severity**: Mitigation time is 15 days.
- **Low Severity**: Mitigation time is 30 days.
- All timelines are subject to approval from business functions and approved downtime.

### 6.5 Post Assessment Phase (Reporting and Monitoring)
- **Reporting**: 
  - Convert the final list of rated vulnerabilities into a separate Vulnerability Assessment (VA) report, which should include:
    - Vulnerabilities
    - Affected assets
    - Server details
    - Vulnerability ratings
    - Recommendations for fixes
    - Best practices
  - Prepare a management summary report of the vulnerability assessment and share it with respective teams.

- **Monitoring**: 
  - Continuously monitor the Vulnerability Assessment as per the VAPT Report evaluation checklist.

### 6.6 Penetration Testing
- Penetration testing assesses the system’s ability to protect its networks, applications, endpoints, and users from threats based on vulnerabilities.
- It ensures security controls are effective and only authorized access is permitted.
- Penetration testing is essential for:
  - Checking infrastructure before potential hacker attacks.
  - Evaluating the efficiency of network security devices (e.g., firewalls, routers, web servers).
  - Ensuring applications and products are not released with vulnerabilities.
- Penetration testing should be performed annually by a third party or whenever:
  - New threats are discovered by security systems.
  - There is an upgrade to a new system, installation of new software, or setup of new infrastructure.

### 6.7 Process of Penetration Testing

- **Planning & Preparation**: Define the goals and objectives of the penetration testing. The IS Team/Project Team and/or an external party are responsible for this process.

- **Reconnaissance**: Assess preliminary information to obtain complete and detailed information about the systems.

- **Discovery**: Use automated tools to scan target assets for discovering vulnerabilities, including:
  - **Network Discovery**: Identify additional systems, servers, and devices (e.g., core servers, domain controllers, email platforms, ERP, and ERM systems).
  - **Host Discovery**: Discover open ports on these devices.
  - **Service Running**: Probe ports to identify actual services running on them.

- **Analyzing Information and Risks**: Analyze and assess the gathered information before testing. Evaluate:
  - The defined goals of the penetration test.
  - The potential risks to the system.

- **Active Intrusion Attempts**: Perform this critical step with due care to verify potential vulnerabilities.

- **Final Assessment**: Evaluate all conducted steps and assess the vulnerabilities present as potential risks.

- **Report Preparation**: Start with an overview of testing procedures, followed by an assessment of vulnerabilities and risks. Prioritize high risks and critical vulnerabilities before addressing lower-order issues.

### 6.8 Phases of Penetration Testing Methodology

- All parties must understand the scope, types of testing (internal or external), rules of engagement, documentation, success criteria, review of past threats and vulnerabilities, awareness and education, tools to be used, and avoid scanning security appliances.

- The phases of penetration testing methodology are divided into three steps:

  **Pre-Attack Phase**:
  - Gather information on all physical and logical infrastructure, including analog connections (phone lines, fax lines, dial-up lines) and other potential exploitation information.
  
  **Passive Reconnaissance**:
  - Find directory structures of web servers and services.
  - Gather competitive intelligence from social media.
  - Conduct social engineering regarding the infrastructure.

  **Active Reconnaissance**:
  - **Network Mapping**: Determine network architecture through server domains or directory structures.
  - **Perimeter Mapping**: Use traceroute to define the outer network layer and configurations of switches, routers, and firewalls.
  - **System and Service Identification**: Identify live systems and IP addresses, port states (open, closed, or filtered), protocols used, active services, service types, OS fingerprinting, version identification, and internal IP addressing.
  - **Web Profiling**: Analyze all web-based forms, types of user input, and form submission destinations.

### 6.9 Attack Phase

- Compromise the target system using various tools and techniques to exploit logical and physical vulnerabilities identified in the pre-attack phase.

- **Network Security**: Penetration testers should check for the following:
  - Port scanning.
  - System identification.
  - Services identification.
  - Application testing and code review.
  - Router configuration.
  - Firewall configuration.
  - IDS configuration.

### 6. Testing for Password Cracking and DoS/DDoS
- Conduct testing for password cracking.
- Conduct testing for Denial of Service (DoS) and Distributed Denial of Service (DDoS).

### 6.1 Wireless Security
Penetration testers should check the following to secure a wireless network:
- Test for Access Point (AP) SSID.
- Test radio configuration.
- Test encryption type.
- Test rate and mode of operation.
- Test VLAN.
- Test radio frequency management.
- Conduct a privacy review.

### 6.2 Application Security
Penetration testers should check the following to secure an application architecture:
- Test for SSL/TLS.
- Validate input.
- Test for buffer overflow.
- Test for hidden fields and sensitive information.
- Test for file extensions.
- Test for HTTP methods.
- Test business logic.
- Test for Cross-site Scripting (XSS).
- Test for SQL injection.
- Conduct authentication testing.
- Ensure credentials are transported over an encrypted channel (check for SSL/HTTPS).
- Test for guessable user accounts.
- Conduct brute force testing.
- Test for bypassing authentication schema.
- Test for vulnerabilities in "remember password" and password reset features.
- Test logout and browser cache management.
- Test for backdoors.
- Test multiple factors of authentication.
- Conduct authorization testing.
- Test for bypassing authorization CAPTCHA schema.
- Test for privilege escalation.
- Test for session management.
- Test session management schema.
- Test cookie attributes (http only, secure, and time validity).
- Test for session fixation.
- Test for Cross-Site Request Forgery (CSRF).

### 6.3 Physical Security
To ensure security against physical attacks, implement the following procedures:
- Conduct access controls testing.
- Perform perimeter review.
- Conduct monitoring review.
- Test alarm response.
- Review location security.
- Conduct environment review.

### 6.4 Social Engineering
To ensure security against social engineering attacks, implement the following:
- Conduct request testing.
- Conduct guided suggestion testing.
- Conduct trust testing.

### 6.5 Post Attack Phase
After an attack, the following actions must be taken:
- Remove all files uploaded to the system.
- Clean all registry entries and remove any vulnerabilities created.
- Reverse all file and settings manipulations done during the test.
- Reverse all changes in privileges and user settings.
- Remove all tools and exploits from the tested systems.
- Restore the network to the pretest stage by removing shares.
- Map the network state.

### 6.6 Post Attack Phase Documentation
- Conduct a thorough investigation and validation of the entire test results.
- Document and report all test findings along with a mitigation plan.
- The mitigation plan should include suggestions for remediation of identified vulnerabilities and exploits.
- The final report is confidential and will be delivered only to authorized personnel.

### 6.7 Specific Risks of Vulnerability Assessment and Penetration Testing (VAPT)
- **Technical Risks**: Include failure of the target system or interconnected systems, disruptions of service, reduced performance, modification or contamination of data, and disclosure of data.
- **Organizational Risks**: Include unnecessary triggering of incident handling processes, disruption of business processes, and loss of reputation if third parties are affected.
- **Legal Risks**: Include the possibility of violating legal and contractual obligations and mistakenly committing punishable acts.

### 6.8 References for VAPT
- OWASP Testing Guide
- National Vulnerability Database (NVD)
- Common Vulnerability Scoring System (CVSS)
- Common Vulnerabilities and Exposure (CVE)

### 6.9 List of Tools for Vulnerability Assessment and Penetration Testing
1. **Burp Suite**
   - License: Commercial/Free Limited Function
   - Platform: Windows/Linux/Mac

### 7. Exit Criteria and Output
- The output of the Vulnerability Assessment and Penetration Testing (VAPT) includes:
  - VAPT Report
  - Remediation Plan and Closure Report

### 8. Roles and Responsibilities

**IS Operations / Cloud Service Security Team (Internal)**
- Provide all IT infrastructure details related to the design, implementation, and operation of the Trianz network.
- Perform Vulnerability Assessment (VA) for all IT security and Trianz critical devices.
- Remediate identified vulnerabilities as per the VA Report.
- Conduct VA as per the Trianz Vulnerability Management policy once every three months or based on project requirements.
- Conduct Penetration Testing (PT) for critical systems once a year.

**External Party (External)**
- Conduct penetration testing.

**Internal Apps Team / Delivery Teams (Internal)**
- Provide all internal and external application details related to the design, implementation, and operation of Trianz Applications and Client Applications (where applicable) to the IS & InfoSec team.
- Remediate identified vulnerabilities as per the VAPT Report.

**InfoSec & Dataprivacy Assurance Team (Internal)**
- Review the VAPT scan report.
- Track the closure report.

**CIO/CISO (Internal)**
- Review and approve the final VAPT report.

### 9. Prerequisites

**9.1 Resource**
- VAPT Tools

**9.2 Training**
- VAPT assessment Training

**9.3 Reference Policy, Process, Procedure, Templates, Checklist**
- Vulnerability Management and Penetration Testing Policy
- Network Security Management Procedure
- Prevention and Detection of Malicious Attack Procedure
- Risk and Opportunity Management Procedure
- Anti-Malware Policy

**9.4 Acronyms/Abbreviations**
- VA/PT: Vulnerability Assessment/Penetration Test
- OEM: Original Equipment Manufacturer
- SANS: SysAdmin, Audit, Network and Security
- OWASP: Open Web Application Security Project
- NVD: National Vulnerability Database
- CVSS: Common Vulnerability Scoring System
- MPLS: Multi-Protocol Label Switching
- VLAN: Virtual Local Area Network
- IDS: Intrusion Detection System
- IPS: Intrusion Prevention System
- UTM: Unified Threat Management
- OS: Operating System
- CVE: Common Vulnerabilities and Exposure
- CIO/CISO: Chief Information Officer/Chief Information Security Officer
- ERP: Enterprise Resource Planning
- ERM: Enterprise Risk Management
- FTP: File Transfer Protocol
- DoS and DDoS: Denial of Service and Distributed Denial of Service
- AP SSID: Access Point, Service Set Identifier
- SSL/TLS: Secure Sockets Layer / Transport Layer Security
- HTTP: HyperText Transfer Protocol
- XSS: Cross-Site Scripting
- SQLi: Structured Query Language Injection
- CAPTCHA: Completely Automated Public Turing test to tell Computers and Humans Apart
- CSRF: Cross-Site Request Forgery

### 10. Measurement
- Refer to VAPT reports.

### 11. Standards Addressed
- ISO 27001:2022
- ISO 27701:2019

### 12. ISO Control Mapping(s)
- **Category of Control**: Technological
  - **ISO 27001:2022 Control**: 8.8 Management of technical vulnerabilities
  - **Document Name as per ISO 27001:2022**: Vulnerability Assessment and Penetration Testing

### 8. Technical Vulnerabilities Procedure
- The organization shall obtain information regarding technical vulnerabilities of information systems in use.
- The organization's exposure to such vulnerabilities shall be evaluated.
- Appropriate measures shall be taken based on the evaluation of vulnerabilities.

### Version History
1. **Version 0.00**
   - **Author:** Jyotessh G Nair
   - **Date:** 19-Feb-07
   - **Reason for Change:** Initial Draft
   - **Change Description:** None

2. **Version 1.00**
   - **Author:** Jyotessh G Nair
   - **Date:** 26-Feb-07
   - **Reason for Change:** Baseline approved
   - **Change Description:** Approved Baseline by Zulfikar Deen

3. **Version 1.01**
   - **Author:** Bharateesha B R
   - **Date:** 24-Feb-09
   - **Reason for Change:** New Asset Management Framework
   - **Change Description:** Formatted the document to incorporate the new asset management framework.

4. **Version 1.02**
   - **Author:** Bharateesha B R
   - **Date:** 11-Mar-09
   - **Reason for Change:** New Asset Management Framework
   - **Change Description:** Included Records in the scope of section "Labeling of Information – Soft Copy." Made changes to the guidelines for each classification.

5. **Version 2.00**
   - **Author:** Balu Nair
   - **Date:** 28-Apr-09
   - **Reason for Change:** Approved for Baseline
   - **Change Description:** Baselined

6. **Version 2.01**
   - **Author:** Bharateesha B R
   - **Date:** 23-June-09
   - **Reason for Change:** 2nd Surveillance audit
   - **Change Description:** Removed “Hard Copy” for the control area "Labeling of Information (documents and Records – soft copy)." Changed point 3 of the guidelines for control area "Dispatch and Distribution of Information (Electronic Mail)" for the classification “Confidential.”

7. **Version 3.00**
   - **Author:** Bharateesha B R
   - **Date:** 23-June-09
   - **Reason for Change:** Approval for Baseline
   - **Change Description:** Baselined

8. **Version 3.01**
   - **Author:** Chakravarthi
   - **Date:** 30-Dec-10
   - **Reason for Change:** QMG review
   - **Change Description:** Formatted entire document.

9. **Version 4.00**
   - **Author:** Chakravarthi
   - **Date:** 31-Dec-10
   - **Reason for Change:** Request for approval
   - **Change Description:** Baselined

10. **Version 4.01**
    - **Author:** Srilakshmi
    - **Date:** 24-May-11
    - **Reason for Change:** QMG Review
    - **Change Description:** Modified release ID in header and cover page.

11. **Version 5.00**
    - **Author:** Srilakshmi
    - **Date:** 24-May-11
    - **Reason for Change:** Approval for Baseline
    - **Change Description:** Baselined.

12. **Version 5.01**
    - **Author:** Sudharsana
    - **Date:** 3-Aug-11
    - **Reason for Change:** QMG review
    - **Change Description:** Replaced Owner with Management Representative in place of CIO. Removed Retention period in Document Classification scheme section.

13. **Version 6.00**
    - **Author:** Sudharsana
    - **Date:** 3-Aug-11
    - **Reason for Change:** Request for approval
    - **Change Description:** Approved and Baseline.

### 7.00 Approval of Standardization of Blue Book Process
- **Approved by:** Balu Nair on 08-Nov-12
- **Modifications:**
  - Template format was modified.
  - Logo was changed.

### 7.01 Client Audit and Alignment
- **Approved by:** Paramita Ghosh and Balu Nair on 25-Jan-16
- **Changes Made:**
  - Handling of information is based on the type of Information Asset Classification.
  - Updated control areas to include:
    - Identification of data owners.
    - Criteria for accessing data based on confidentiality.
    - Labelling mechanism for sensitive documents.
    - Validation of data classification, which needs periodic verification.
    - Data retention period based on regulatory requirements, sensitivity, and information type.
    - Appropriate encryption methodologies for data in transit.
    - Documentation for secure disposal of data.
  - All confidential/sensitive data must be encrypted.
  - Added a separate "REFERENCES" section.

### 8.00 Approval by CISO
- **Approved by:** Balu Nair on 08-Feb-16
- **Approved by:** Mahesh (CISO)

### 8.1 Migration to New Template
- **Reviewed by:** Karthik N on 3-Jan-22
- **Status:** For Review

### 9.0 Approval and Baselining
- **Approved by:** Karthik N, Siva N on 3-Jan-22
- **Status:** For Approval

### 9.0 Annual Review
- **Reviewed by:** Kruti, Vijaya on 3-June-24
- **Status:** No Changes

### 9.1 Migration to New Template for Annual Review
- **Reviewed by:** Vijaya, Balu on 28-May-25
- **Status:** For Annual Review

### 10.0 Approval and Baselining
- **Approved by:** Vijaya, Balu, Srikanth M on 29-May-25
- **Status:** For Approval

### Contact Information
- **Email:** infosec@trianz.com

### Copyright Notice
- The content in this document is copyrighted. Unauthorized use may violate copyright, trademark, and other laws. This document may not be modified, reproduced, publicly displayed, performed, distributed, or used for any public or commercial purposes. The Trianz name and its products are subject to trademark and copyright protections.